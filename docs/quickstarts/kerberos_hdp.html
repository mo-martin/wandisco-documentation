<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Kerberos (HDP) integration with Fusion · WANdisco docs</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="[//]: &lt;To-do = NameNode Proxy integration.&gt;"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Kerberos (HDP) integration with Fusion · WANdisco docs"/><meta property="og:type" content="website"/><meta property="og:url" content="https://wandisco.github.io/wandisco-documentation/ https://wandisco.github.io/wandisco-documentation/"/><meta property="og:description" content="[//]: &lt;To-do = NameNode Proxy integration.&gt;"/><meta property="og:image" content="https://wandisco.github.io/wandisco-documentation/ https://wandisco.github.io/wandisco-documentation/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://wandisco.github.io/wandisco-documentation/ https://wandisco.github.io/wandisco-documentation/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="https://wandisco.github.io/wandisco-documentation/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://wandisco.github.io/wandisco-documentation/js/scrollSpy.js"></script><link rel="stylesheet" href="https://wandisco.github.io/wandisco-documentation/css/main.css"/><script src="https://wandisco.github.io/wandisco-documentation/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="https://wandisco.github.io/wandisco-documentation/"><img class="logo" src="https://wandisco.github.io/wandisco-documentation/img/favicon.png" alt="WANdisco docs"/><h2 class="headerTitleWithLogo">WANdisco docs</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://wandisco.github.io/wandisco-documentation/docs/quickstarts/installation/quickstart-config" target="_self">Quickstarts</a></li><li class=""><a href="https://wandisco.github.io/wandisco-documentation/docs/docs/doc1" target="_self">Docs</a></li><li class=""><a href="https://wandisco.github.io/wandisco-documentation/docs/glossary/a" target="_self">Glossary</a></li><li class=""><a href="https://wandisco.github.io/wandisco-documentation/docs/api/api" target="_self">API</a></li><li class=""><a href="https://wandisco.github.io/wandisco-documentation/help" target="_self">Help</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Kerberos (HDP) integration with Fusion</h1></header><article><div><span><p><em>THIS GUIDE IS WORK IN PROGRESS, PLEASE DO NOT FOLLOW ANYTHING HERE UNTIL THIS WARNING IS REMOVED</em></p>
<h2><a class="anchor" aria-hidden="true" id="introduction"></a><a href="#introduction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h2>
<p>This guide should be followed when you want to enable your Fusion installation to work with a Kerberized Hortonworks (HDP) cluster.</p>
<h2><a class="anchor" aria-hidden="true" id="prerequisites"></a><a href="#prerequisites" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h2>
<ul>
<li><p>Fusion has been installed and configured with a HDP zone. See <a href="https://wandisco.github.io/wandisco-documentation/docs/quickstarts/installation/quickstart-config">Quickstart guidance</a> for relevant documentation on how to achieve this.</p></li>
<li><p>An <code>/etc/hosts</code> entry for the Docker hostname plus <code>fusion-server-hdp</code> on all nodes in the HDP cluster.</p>
<p><em>Example -</em> <code>172.0.0.4 docker_host01 fusion-server-hdp</code></p></li>
<li><p>KDC administrator credentials for the HDP cluster.</p></li>
<li><p>A Kerberos keytab and principal to be used with Fusion. The principal must map to a user that has superuser permissions. This is commonly done by using the HDFS keytab with Fusion.</p>
<hr>
<p>This could also be done by creating a keytab and principal for Fusion with either:</p>
<ul>
<li><p>An <a href="https://docs.cloudera.com/HDPDocuments/HDP3/HDP-3.1.4/security-reference/content/kerberos_nonambari_creating_mappings_between_principals_and_unix_usernames.html">auth_to_local</a> rule that maps the Fusion principal to a superuser.</p>
<p><em>Example rule</em> - <code>RULE:[1:$1@$0](fusionuser@WANDISCO.HADOOP)s/.*/hdfs/</code></p></li>
<li><p>An <a href="https://docs.cloudera.com/HDPDocuments/HDP3/HDP-3.1.4/security-reference/content/kerberos_nonambari_creating_mappings_between_principals_and_unix_usernames.html">auth_to_local</a> rule that maps the Fusion principal to a user that is added to the HDFS supergroup on the NameNodes.</p>
<p><em>Example rule</em> - <code>RULE:[1:$1@$0](fusionuser@WANDISCO.HADOOP)s/.*/fusionuser/</code></p>
<p><em>Example command on NameNodes</em> - <code>usermod fusionuser -G hdfs</code></p></li>
</ul>
<hr></li>
<li><p>The keytab to be used with Fusion should be stored in the <code>/etc/security/keytabs</code> directory on the Ambari Server.</p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="integrating-kerberos-with-fusion"></a><a href="#integrating-kerberos-with-fusion" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Integrating Kerberos with Fusion</h2>
<p>This method will allow the Hadoop configuration and Kerberos keytabs to be shared with the Fusion installation, by inducting a specific container into the HDP cluster.</p>
<h3><a class="anchor" aria-hidden="true" id="add-the-sshd-container-to-the-hdp-cluster"></a><a href="#add-the-sshd-container-to-the-hdp-cluster" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Add the SSHD container to the HDP cluster</h3>
<ol>
<li><p>Log in to the Docker host, and switch to the fusion-docker-compose directory.</p>
<p><code>cd /path/to/fusion-docker-compose</code></p></li>
<li><p>Ensure the Fusion containers are running.</p>
<p><code>docker-compose ps</code></p></li>
<li><p>Run a command to obtain the private key of the SSHD container for the HDP zone.</p>
<p><code>docker logs fusion_sshd-hdp_1</code></p>
<p><em>Example output</em></p>
<pre><code class="hljs css language-text">-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAuK38KexpwnOYE+hI0a+UXtgNoE1JVPp0n+/DOCTs9AKkpm8e
bwkVg/sErvRQ63l0gPc7YXiQClc7Ha11rUe1rTez8Hx0MmDcWEwiuFT3Hoonc3Sh
WNqcua7R8+r+HOS5+CRHAx/25ogdPeygX+U+PyIutGHvHI4I37Z/tRwmakFlfLuF
jgcqjhuqfjY60hM90aoyL2AnGb5pfsEKo2hB8oEquNciuPJo5FHk+3NFpOWLMcwG
1OQpHjoBLNxZuuZP2C6KTQjodvuLIx/DaA33t2MIJQVKn0sL3wp2PP/ZD59CVqbV
XmaDoNG0jm0b+PYH97MBS2p2BCVGqskx7TvR6QIDAQABAoIBAB+HrNang0Lso1k6
vjv2gxlSP7lPmKaGgCTSNX0/aKkcTmoP7J1+asr2r00Db1FUkhx2mSQNBmKNlA00
ETQ9Wvow2WrEhL4ZJWV50i+waeRv595hWi6mXD2jaDsBstLSBiIkZ29UJL4lHQD2
hkb5B5CV0G2BjuZMJZ20NceA/9oB+AALfo+X6wR610AkWXCDJOClJHbU6fa8fPAO
pp+ucbsZ1EIuCpupV3lWZpDJw4Jw2aqDrIq7UX+hqfE38pePSBL6jLHiQACEyehU
lqbmSInZFuMSAjuVK/Ewp8nxsEAJ4gH4RJx6DcE0XnaGEO03b6aFDqktbv0jhKWS
igJHGAECgYEA38KQxlbcxWPW1CclHlJG4tou8hDjPWZ4haEVujxsvrKpbVethxsM
4Q7VK4ePbIwnEAHjHZw48hsXCumk1ECo91N48L/YuxHWwuRMm9KozbxjyQUl2tjg
u8nCSXWWDj89VW+Z+Q8ye3DHr7m8JaarSafy5Pov+XSvmXUfIxLBQwECgYEA00nu
YGxZiTy2jhwL7V7QvUMqsFgc8AXnYcKLG1wXGJhUCVbzjFcKIofEnUiYIfDPl7uJ
S7tQiaeRkl9z7YuV1GH2vtu2WJL/zItG8uFy0CbvNsrsVXMxYFeegAwKijsonGR/
K4ZCdrao8sIli+EHkmgUAYrzmgoDoFr4M5RT1ukCgYBNiMjLwUuMplTJfKry/8WK
U9oSjOGA5CH9A91YhBmWVqg4uDnr5+alkZMyGy4KieH7PPwqxXhCBDsOz/kKh0FF
Okpc+c0qvTqym5MkJ3HQoGooPwZn9+CfkYDeHX2agDVLhnj2TFrMxT6cWHqmfUM7
KZQT3dGD2fgC77+TUqtfAQKBgA3offKG71XjUzkDi51yclcjBrpY8n6yRMrgnXuN
kk+iJ1X+DUYdrKMdQMoBr1H8og2g4KbFi8Wj7CcwdVcbqx8x26YwnE40TvZN7Lus
L3yYM4Lt1KTDUmq/GcXgBQmYX1H8I4rf6Zwa5gAk24fbpj3y7+4yEVsAccCrie8L
QoGRAoGAHk/qaX1BTLOtjp6pc7TfYAUpPkhBHjT22eQOjdlUxfV6nbun/pN1/ZXP
v1a+mgvGqUw24CP+2ZBcLICSk4dlSECy6tUyvLle7iEYMrMRZDyxVrxtFwG3NZKH
LYoIZTJyKjilWf2otcq/CXief6NA5yfQyK7b3MCYTA6kyV/KlyZ=
-----END RSA PRIVATE KEY-----
</code></pre>
<p>Save this private key as a file (e.g. <code>hdp-key.pem</code>) or copy to clipboard to be used later.</p></li>
<li><p>Log in to the Ambari Server via a terminal session and confirm that the container is accessible via ssh.</p>
<p><code>ssh -i hdp-key.pem -p 2022 root@&lt;DOCKER_HOSTNAME&gt;</code></p>
<p>Either copy the <code>hdp-key.pem</code> file over to the Ambari Server or create the file and paste in the contents of your clipboard. You can exit the container once SSH access is confirmed.</p>
<p>You may need to set permissions of the key to read only before using it.</p>
<p><em>Example</em></p>
<p><code>chown 400 hdp-key.pem</code></p></li>
<li><p>Log in to the Ambari UI and select to Add New Hosts.</p>
<p><strong>Ambari UI -&gt; Hosts -&gt; Actions -&gt; Add New Hosts</strong></p></li>
<li><p>In the Add Host Wizard, provide the following information:</p>
<ul>
<li>Target Hosts - Enter the docker hostname in this field.</li>
<li>Host Registration Information - Provide the contents of the private key file from the docker SSHD container (i.e. <code>hdp-key.pem</code>).</li>
<li>SSH Port Number - change the port number to <code>2022</code>.</li>
</ul>
<p>Click <strong>REGISTER AND CONFIRM</strong> when done.</p></li>
<li><p>Wait for the host checks are completed in the <strong>Confirm Hosts</strong> step.</p>
<p>There is a possibility that the Java version required will not be installed on the SSHD container. If so, then you will need to transfer the JDK to the SSHD container.</p>
<p><em>Example</em></p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# scp -i hdp-key.pem -P 2022 /usr/java/jdk1.8.0_XYZ.tar.gz &lt;SSHD_CONTAINER&gt;:~</code></p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# ssh -i hdp-key.pem -p 2022 &lt;SSHD_CONTAINER&gt;</code></p>
<p><code>[root@&lt;SSHD_CONTAINER&gt; ~]# mkdir -p /usr/java</code></p>
<p><code>[root@&lt;SSHD_CONTAINER&gt;&gt; ~]# tar -xf jdk1.8.0_XYZ.tar.gz -C /usr/java/</code></p>
<hr>
<p>Check that the JCE policy is set to unlimited strength (see the <a href="https://bugs.java.com/bugdatabase/view_bug.do?bug_id=JDK-8170157">Oracle bug report</a> for further information), the output from the command below should read <code>true</code> if this is the case.</p>
<p><code>/usr/java/jdk1.8.0_XYZ/bin/jrunscript -e 'print (javax.crypto.Cipher.getMaxAllowedKeyLength(&quot;RC5&quot;) &gt;= 256);'</code></p>
<p>If the command returns <code>false</code>, you may want to enable unlimited strength policies.</p>
<ul>
<li><p><strong>Java 8 Update 161 or higher</strong> - Edit the <code>java.security</code> file in <code>/usr/java/jdk1.8.0_XYZ/jre/lib/security</code> (for JDK) or <code>/usr/java/jdk1.8.0_XYZ/lib/security</code> (for JRE). Uncomment or include the line:</p>
<p><code>crypto.policy=unlimited</code></p></li>
<li><p><strong>Java 8 Update 160 or below</strong> - Download the unlimited strength JCE policy files from Oracle <a href="http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html">here</a> and transfer the zip file to the SSHD container. Log in to the container afterwards.</p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# scp -i hdp-key.pem -P 2022 jce_policy-8.zip &lt;SSHD_CONTAINER&gt;:~</code></p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# ssh -i hdp-key.pem -p 2022 &lt;SSHD_CONTAINER&gt;</code></p>
<p><em>or</em></p>
<p><code>root@&lt;DOCKER_HOST&gt;:~# docker cp jce_policy-8.zip &lt;CONTAINER-ID_of_fusion_sshd-hdp_1&gt;:/root/</code></p>
<p><code>root@&lt;DOCKER_HOST&gt;:~# docker exec -it fusion_sshd-hdp_1 bash</code></p>
<p>Extract the policy files and replace the existing policy JAR files in <code>/usr/java/jdk1.8.0_XYZ/jre/lib/security</code> with the unlimited policy ones.</p>
<p><code>[root@&lt;SSHD_CONTAINER&gt;&gt; ~]# unzip jce_policy-8.zip</code></p>
<p><code>[root@&lt;SSHD_CONTAINER&gt;&gt; ~]# cp UnlimitedJCEPolicyJDK8/US_export_policy.jar /usr/java/jdk1.8.0_XYZ/jre/lib/security/</code></p>
<p><code>[root@&lt;SSHD_CONTAINER&gt;&gt; ~]# cp UnlimitedJCEPolicyJDK8/local_policy.jar /usr/java/jdk1.8.0_XYZ/jre/lib/security/</code></p>
<p>Select to overwrite the existing files when prompted.</p></li>
</ul>
<hr>
<p>Any warnings relating to the <code>/etc/hadoop</code> path should be ignored as the SSHD container will use symlinks to retain Hadoop configuration.</p>
<p>Click Next once complete.</p></li>
<li><p>On the <strong>Assign Slaves and Clients</strong> step, ensure that the Client option is selected for the Docker host. Click Next once confirmed.</p></li>
<li><p>On the <strong>Configurations</strong> step, unless a specific Configuration Group is required, leave the services on Default and click Next.</p></li>
<li><p>Click Deploy on the <strong>Review</strong> step.</p></li>
<li><p>If Kerberos is enabled on the cluster, enter your KDC administrator credentials on the pop-up window and click Save.</p></li>
<li><p>Wait until the <strong>Install, Start and Test</strong> procedure is complete, then click Next.</p></li>
<li><p>On the Summary page, click Complete.</p></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="configure-the-hdp-cluster"></a><a href="#configure-the-hdp-cluster" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure the HDP cluster</h3>
<ol>
<li><p>Transfer the Kerberos configuration file for the cluster into the SSHD container.</p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# scp -i hdp-key.pem -P 2022 /etc/krb5.conf &lt;SSHD_CONTAINER&gt;:/etc/shared/krb5.conf</code></p></li>
<li><p>If required, transfer the keytab to be used with Fusion to the SSHD container.</p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# scp -i hdp-key.pem -P 2022 /etc/security/keytabs/${FUSION_KEYTAB}.keytab &lt;SSHD_CONTAINER&gt;:/etc/security/keytabs/</code></p>
<p>This should not be required if using an auto-generated keytab (such as the <code>hdfs</code> keytab) within the <code>/etc/security/keytabs</code> directory, as it will have been mapped to the SSHD container automatically.</p></li>
<li><p>Create two directories within HDFS on the cluster that will be used specifically by Fusion (ensure to <code>kinit</code> beforehand).</p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# hdfs dfs -mkdir -p /wandisco/exchange_dir</code></p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# hdfs dfs -mkdir -p /wandisco/handshake_tokens</code></p>
<p>Ensure they are owned by the Fusion user, in the example below, the Fusion user will be <code>hdfs</code>.</p>
<p><code>[root@&lt;AMBARI_SERVER&gt; ~]# hdfs dfs -chown hdfs:hdfs -R /wandisco</code></p></li>
<li><p>Add Fusion properties to the HDFS config on the cluster.</p>
<p><strong>Ambari UI -&gt; HDFS -&gt; Configs -&gt; Advanced -&gt; Custom core-site</strong></p>
<p>Select to add the properties below in <strong>Bulk property add mode</strong>.</p>
<pre><code class="hljs css language-text">fusion.client.ssl.enabled=false
fusion.handshakeToken.dir=/wandisco/handshake_tokens
fusion.http.authentication.enabled=false
fusion.http.authorization.enabled=false
fusion.replicated.dir.exchange=/wandisco/exchange_dir
fusion.server=fusion-server-hdp:8023
</code></pre>
<p>Next, add the properties below but adjust the values (encased with <code>${}</code>) so that they are correct for your environment:</p>
<pre><code class="hljs css language-text">fs.fusion.underlyingFs=hdfs://${CLUSTER_NAMESERVICE} or hdfs://${NAMENODE}:${PORT}
fusion.keytab=/etc/security/keytabs/${FUSION_KEYTAB}.keytab
fusion.principal=${FUSION_PRINCIPAL}@${REALM}
hadoop.proxyuser.${FUSION_USER}.hosts=fusion-server-hdp
hadoop.proxyuser.${FUSION_USER}.groups=*
</code></pre>
<p><em>Example</em></p>
<pre><code class="hljs css language-text">fs.fusion.underlyingFs=hdfs://nameservice01
fusion.keytab=/etc/security/keytabs/hdfs.keytab
fusion.principal=hdfs-hdp-01@$REALM.COM
hadoop.proxyuser.hdfs.hosts=fusion-server-hdp
hadoop.proxyuser.hdfs.groups=*
</code></pre>
<p>If the <code>hadoop.proxyuser.${FUSION_USER}.hosts</code> property already exists with predefined hostnames, please append <code>fusion-server-hdp</code> to the value (comma-delimited).</p>
<p><em>Example -</em> <code>hadoop.proxyuser.hdfs.hosts=hdp_namenode01,hdp_namenode02,fusion-server-hdp</code></p>
<p>If this property value is a wildcard (<code>*</code>), then it does not need to changed.</p>
<p><strong>Save</strong> the HDFS config once all additions have been made.</p></li>
<li><p><strong>Restart the cluster services.</strong></p></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="configure-fusion"></a><a href="#configure-fusion" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure Fusion</h3>
<ol>
<li><p>Log in to the Docker host via terminal, edit the <code>ui.properties</code> file on the Fusion UI container in the HDP zone.</p>
<p><code>root@&lt;DOCKER_HOST&gt;:~# docker exec -it fusion_fusion-ui-server-hdp_1 bash</code></p>
<p><code>[hdfs@&lt;FUSION_UI_HDP&gt; /]$ vi /opt/wandisco/fusion-ui-server/properties/ui.properties</code></p>
<p>Add the following properties below, but adjust the values (prefixed with <code>$</code>) so that they are correct for your environment:</p>
<pre><code class="hljs css language-json">cluster.kerberos.configured=true
kerberos.enabled=true
kerberos.config.path=/etc/krb5.conf
kerberos.principal=${FUSION_PRINCIPAL}@${REALM}
kerberos.keytab.path=/etc/security/keytabs/${FUSION_KEYTAB}.keytab
kerberos.generated.config.path=/opt/wandisco/fusion-ui-server/lib/kerberos.conf
</code></pre>
<p>Once complete, save and quit the file. Exit the container once complete.</p>
<p><code>exit</code></p></li>
</ol>
<ol start="2">
<li><p>Adjust the ownership of required files inside of one of the Fusion containers in the HDP zone.</p>
<p><code>root@&lt;DOCKER_HOST&gt;:~# docker exec -u root -it fusion_fusion-server-hdp_1 bash -c 'chown hdfs:hdfs /etc/security/keytabs/hdfs.headless.keytab /etc/hadoop/conf/core-site.xml /etc/hadoop/conf/hdfs-site.xml'</code></p></li>
<li><p>Restart the Fusion containers in the HDP zone (except SSHD) so that the configuration is picked up by Fusion. You must be inside the <code>fusion-docker-compose</code> directory to run this command.</p>
<p><code>root@&lt;DOCKER_HOST&gt;:~/fusion-docker-compose# docker-compose restart fusion-ihc-server-hdp fusion-server-hdp fusion-ui-server-hdp fusion-nn-proxy-hdp</code></p></li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="troubleshooting"></a><a href="#troubleshooting" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Troubleshooting</h2>
<h3><a class="anchor" aria-hidden="true" id="starting-the-ambari-agent"></a><a href="#starting-the-ambari-agent" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Starting the Ambari Agent</h3>
<p>When restarting the SSHD container (or all containers), the <code>ambari-agent</code> service will not be started automatically.</p>
<p>To start it, log in to the Docker host and run the command below:</p>
<p><code>docker exec -it fusion_sshd-hdp_1 bash -c 'ambari-agent start'</code></p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#introduction">Introduction</a></li><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#integrating-kerberos-with-fusion">Integrating Kerberos with Fusion</a><ul class="toc-headings"><li><a href="#add-the-sshd-container-to-the-hdp-cluster">Add the SSHD container to the HDP cluster</a></li><li><a href="#configure-the-hdp-cluster">Configure the HDP cluster</a></li><li><a href="#configure-fusion">Configure Fusion</a></li></ul></li><li><a href="#troubleshooting">Troubleshooting</a><ul class="toc-headings"><li><a href="#starting-the-ambari-agent">Starting the Ambari Agent</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://wandisco.github.io/wandisco-documentation/" class="nav-home"></a><div><h5>Docs</h5><a href="https://wandisco.github.io/wandisco-documentation/docs/en/quickstarts/quickstart-config.html">Getting Started</a><a href="https://docs.wandisco.com">Product User Guides</a><a href="https://community.wandisco.com/s/knowledge-base">Knowledge Base</a></div><div><h5>Community</h5><a href="https://community.wandisco.com/">WANdisco Community</a><a href="//wandisco.com/partners/find">Partners</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="https://wandisco.com/blog">Blog</a><a href="https://blogs.wandisco.com/">Developer Blog</a><a href="https://github.com/wandisco">GitHub</a></div></section><section class="copyright">Copyright © 2020 WANdisco, Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '56e573413aa88e9ec072a585bec45683',
                indexName: 'wandisco',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>